import{t as P,c as E,e as O,r as g,o as k,a as U,w as m,b as _,u as p,n as j,g as F,d as x,f as B,h as M,i as l,j as H,k as q,p as G,l as Q,m as z,q as S,s as T,v as D,x as K,B as J,I as C,F as W,T as L,S as X}from"./vendor.1d31eacc.js";import Y from"https://esm.sh/copy-to-clipboard";import Z from"https://cdn.jsdelivr.net/npm/codemirror/src/codemirror.js";const ee=function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))o(e);new MutationObserver(e=>{for(const n of e)if(n.type==="childList")for(const d of n.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&o(d)}).observe(document,{childList:!0,subtree:!0});function c(e){const n={};return e.integrity&&(n.integrity=e.integrity),e.referrerpolicy&&(n.referrerPolicy=e.referrerpolicy),e.crossorigin==="use-credentials"?n.credentials="include":e.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function o(e){if(e.ep)return;e.ep=!0;const n=c(e);fetch(e.href,n)}};ee();var te="/assets/github.78818959.svg",ae="/assets/logo.c9f36a96.svg";const ne=["innerHTML"],oe={props:{content:String,loading:Boolean},setup(i){const r=i,{content:c,loading:o}=P(r),e=E(()=>O(c.value));return(n,d)=>{const h=g("a-spin");return k(),U(h,{spinning:p(o)},{default:m(()=>[_("div",j(F(n.$attrs)),[_("div",{innerHTML:p(e)},null,8,ne)],16)]),_:1},8,["spinning"])}}};var I=(i,r)=>{const c=i.__vccOpts||i;for(const[o,e]of r)c[o]=e;return c};const se={class:"my-editor"},re={props:{content:{type:String},readonly:{type:Boolean,default:()=>!1},loading:Boolean},emits:["update:content"],setup(i,{expose:r,emit:c}){const o=i,{content:e,readonly:n,loading:d}=P(o);let h;const y=x(null);B(()=>{h=Z.fromTextArea(y.value,{lineNumbers:!0,readonly:!!n}),typeof e.value=="string"&&b(e.value),h.on("change",(w,a)=>{c("update:content",h.doc.getValue())})});function b(w){h.doc.setValue(w)}return r({update:b}),(w,a)=>(k(),M("div",se,[_("textarea",{ref:(t,s)=>{s.input=t,y.value=t}},null,512)]))}};var A=I(re,[["__scopeId","data-v-5439ba93"]]);const le={props:{content:String,loading:Boolean},setup(i){const r=i,{content:c,loading:o}=P(r);return(e,n)=>{const d=g("a-tab-pane"),h=g("a-tabs");return k(),U(h,{class:"render"},{default:m(()=>[l(d,{key:"1",tab:"Result"},{default:m(()=>[l(oe,{content:p(c),loading:p(o),class:"markdown",style:{"padding-left":"30px"}},null,8,["content","loading"])]),_:1}),l(d,{key:"2",tab:"Source"},{default:m(()=>[l(A,{content:p(c),loading:p(o),readonly:!0},null,8,["content","loading"])]),_:1})]),_:1})}}};const N=i=>(G("data-v-22a21f11"),i=i(),Q(),i),ie={style:{position:"relative"}},ce=N(()=>_("a",{href:"https://github.com/release-lab",target:"_blank",style:{position:"fixed",right:"0",top:"0"}},[_("img",{src:te,style:{width:"60px",height:"60px"}})],-1)),ue={class:"toolbar"},pe=N(()=>_("img",{style:{"max-width":"100%","max-height":"100%"},src:ae},null,-1)),de=T(" Generate "),me=T(" Share "),_e={class:"container"},he={class:"left"},fe={style:{display:"flex",height:"100%","padding-left":"10px"}},ve={class:"right"},ge={setup(i){const r=x(!1),c=x(null),o=x(""),e=H({repo:"https://github.com/release-lab/whatchanged.git",branch:"master",version:"HEAD~"}),n=P(e);function d(a){z(()=>e[a],t=>{h(a,t)})}function h(a,t){const s=new URL(window.location.href);s.searchParams.has(a)?s.searchParams.set(a,t):s.searchParams.append(a,t),window.history.pushState(null,null,s)}d("branch"),d("repo"),d("version");const y=x("");function b(){const a=encodeURIComponent(o.value);r.value=!0;const t=Math.random()+"";S.info({key:t,message:"Generating",description:"This may take a few minutes..."});const s=new URL("https://whatchanged.herokuapp.com");s.searchParams.append("repo",e.repo||""),s.searchParams.append("branch",e.branch||""),s.searchParams.append("version",e.version||""),s.searchParams.append("template",a||""),fetch(s).then(u=>u.text()).then(u=>{S.close(t),y.value=u}).catch(u=>{S.close(t),S.error({message:"Error",description:u.message})}).finally(()=>{r.value=!1})}function w(){const a=new URL(window.location.href);a.searchParams.append("tpl",o.value),Y(a.href),D.info("URL have been copy to clipboard.")}return B(()=>{const a=new URL(window.location.href);let t=0;if(a.searchParams.has("username")&&(e.username=a.searchParams.get("username"),t++),a.searchParams.has("repo")&&(e.repo=a.searchParams.get("repo"),t++),a.searchParams.has("branch")&&(e.repo=a.searchParams.get("branch"),t++),a.searchParams.has("version")&&(e.version=a.searchParams.get("version")),a.searchParams.has("tpl"))t++,o.value=a.searchParams.get("tpl");else{const s=new URL("https://whatchanged.herokuapp.com");s.pathname="/template",fetch(s).then(u=>u.text()).then(u=>{o.value=u,c.value.update(o.value)})}t===3&&e.username&&e.repo&&b()}),(a,t)=>{const s=g("a-input"),u=g("a-form-item"),R=g("a-button"),$=g("a-form");return k(),M("div",ie,[ce,_("div",ue,[pe,l($,{layout:"inline",model:p(n),onSubmit:q(b,["prevent"])},{default:m(()=>[l(u,{label:"Repository",style:{width:"600px"}},{default:m(()=>[l(s,{value:p(n).repo.value,"onUpdate:value":t[0]||(t[0]=f=>p(n).repo.value=f)},null,8,["value"])]),_:1}),l(u,{label:"Branch"},{default:m(()=>[l(s,{value:p(n).branch.value,"onUpdate:value":t[1]||(t[1]=f=>p(n).branch.value=f)},null,8,["value"])]),_:1}),l(u,{label:"Version"},{default:m(()=>[l(s,{value:p(n).version.value,"onUpdate:value":t[2]||(t[2]=f=>p(n).version.value=f)},null,8,["value"])]),_:1}),l(u,null,{default:m(()=>[l(R,{type:"primary","html-type":"submit",loading:r.value},{default:m(()=>[de]),_:1},8,["loading"]),l(R,{type:"default",onClick:w,style:{"margin-left":"20px"}},{default:m(()=>[me]),_:1})]),_:1})]),_:1},8,["model","onSubmit"])]),_("div",_e,[_("div",he,[_("div",fe,[l(A,{ref:(f,V)=>{V.editor=f,c.value=f},template:o.value,"onUpdate:template":t[3]||(t[3]=f=>o.value=f),readonly:!0},null,8,["template"])])]),_("div",ve,[l(le,{content:y.value,loading:r.value},null,8,["content","loading"])])])])}}};var ye=I(ge,[["__scopeId","data-v-22a21f11"]]);const v=K(ye);v.use(J);v.use(C);v.use(C.TextArea);v.use(W);v.use(L);v.use(L.TabPane);v.use(L.TabContent);v.use(X);v.mount("#app");
